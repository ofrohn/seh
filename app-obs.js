function Cdraw(e,t){var n,r,a,i,o,s=e||"canvas",l="normal 16px sans-serif",c="normal 11px sans-serif",h="#000",u="0.5",m="left",d="alphabetic",f=16,p="globalAlpha,globalCompositeOperation,lineCap,lineJoin,miterLimit,shadowBlur,shadowColor,shadowOffsetX,shadowOffsetY";if(n=document.getElementById(s),n||(n=document.createElement("canvas"),n.id=s,n.style.top=0,n.style.left=0,t&&t.hasOwnProperty("parent")&&(o=document.getElementById(t.parent)),o||(o=document.getElementsByTagName("body")[0]),o.appendChild(n)),!n.getContext)return null;if(r=n.getContext("2d"),!r.fillText)return null;this.setheight=function(e){isNumber(e)&&(n.height=e,i=e)},this.setwidth=function(e){isNumber(e)&&(n.width=e,a=e)},this.setsize=function(e){"object"==typeof e&&e.hasOwnProperty("h")&&e.hasOwnProperty("w")&&(n.width=e.w,n.height=e.h,a=e.w,i=e.h)},this.setfont=function(e){e&&(l=e)},this.setexpfont=function(e){e&&(c=e)},this.setcolor=function(e){e&&(h=e)},this.setclip=function(e,t,n,a){r.beginPath(),r.rect(e,t,n,a),r.clip()},this.setclipcircle=function(e,t,n){r.beginPath(),r.arc(Math.round(e)+.5,Math.round(t)+.5,n,0,2*Math.PI,!0),r.clip()},this.setviewport=function(e,t){r.translate(e,t),a-=e,i-=t},this.setparam=function(e,t){-1!=p.search(e)&&(r[e]=t,this[e]=t)};var g=function(e){var t,o;for(t in e)if(e.hasOwnProperty(t))switch(o=e[t],t){case"width":isNumber(o)&&(n.width=o,a=o);break;case"height":isNumber(o)&&(n.height=o,i=o);break;case"top":case"left":n.style[t]=o;break;case"className":n.className=o;break;case"font":l=o;break;case"color":h=o;break;default:-1!=p.search(t)&&(r[t]=o,this[t]=o)}};this.line=function(e,t,n,a,i,o){r.strokeStyle=i||h,r.lineWidth=o||u,r.beginPath(),r.moveTo(Math.round(e)+.5,Math.round(t)+.5),r.lineTo(Math.round(n)+.5,Math.round(a)+.5),r.stroke()},this.hline=function(e,t,n,r,i){var o=n||a;this.line(e,t,e+o,t,r,i)},this.vline=function(e,t,n,r,a){var o=n||i;this.line(e,t,e,t+o,r,a)},this.vtick=function(e,t,n,r,a){var i=n||4;this.line(e,t-i,e,t+i,r,a)},this.htick=function(e,t,n,r,a){var i=n||4;this.line(e-i,t,e+i,t,r,a)},this.cross=function(e,t,n,r,a){this.hline(e-n-1.5,t-.5,n,r,a),this.hline(e+.5,t-.5,n,r,a),this.vline(e-.5,t-n-1.5,n,r,a),this.vline(e-.5,t+.5,n,r,a)},this.dashline=function(e,t,n,r,a,i,o){for(var s=o||[4,4],l=Math.atan2(n-e,r-t),c=Math.sqrt(Math.pow(r-t,2)+Math.pow(n-e,2)),h=e,u=t,m=0,d=0,f=0;Math.sqrt(Math.pow(t-u,2)+Math.pow(e-h,2))<c;)m=h+Math.sin(l)*s[f],d=u+Math.cos(l)*s[f],f%2===0&&this.line(h,u,m,d,a,i),h=m,u=d,f=f==s.length-1?0:f+1},this.setdash=function(e){r.setLineDash&&r.setLineDash(e?e:[0])},this.text=function(e,t,n,a,i,o,s){var c,u;if(e)if(e=e.toString(),r.font=a||l,r.textAlign=i||m,r.fillStyle=o||h,r.textBaseline=s||d,-1!=e.search(/\n/g))for(c=e.match(/[^\n]+/g),u=0;u<c.length;u++)r.fillText(c[u],Math.round(t)+.5,n+u*f);else r.fillText(e,Math.round(t)+.5,n)},this.vtext=function(e,t,n,a,i,o,s){var l;l=s?Math.PI*s/180:1.5*Math.PI,r.save(),r.translate(t,n),r.rotate(l),this.text(e,0,0,a,i,o),r.restore()},this.label=function(e,t,n,r,a,i,o){var s=o||h,l=a||"NE",c="center",u="middle",m=0,d=0,f=this.relPos(l,r);m=f.x,d=f.y,u=f.v,c=f.h,this.text(e,t+m,n+d,i,c,s,u)},this.relPos=function(e,t){var n,r=0,a=0,i="middle",o="center";if(!e||!t||!isNumber(t)||1>=t)return{x:0,y:0,h:o,v:i};switch(n=Math.round(t/2),e.toUpperCase()){case"N":a-=t+n;break;case"NE":a-=t-n,r+=t-n;break;case"E":r+=t+n;break;case"SE":a+=t-n,r+=t-n;break;case"S":a+=t+n;break;case"SW":a+=t-n,r-=t-n+2;break;case"W":r-=t+n;break;case"NW":a-=t-n,r-=t-n+2}return-1!=e.search(/N/g)&&(i="bottom"),-1!=e.search(/S/g)&&(i="top"),-1!=e.search(/E/g)&&(o="left"),-1!=e.search(/W/g)&&(o="right"),{x:r,y:a,h:o,v:i}},this.number=function(e,t,n,a,i,o){var s,l,h,u=i||m;if(s=parseFloat(e).toExponential().match(/(\d*)[eE]\+?(-?\d*)/),!s)return void this.text(e,t,n,a,i,o);if(l=s[1],"1"!=l?l+="Ã—10":l="10",h=s[2],"right"==u)r.font=c,this.text(l,t-r.measureText(h).width-1,n,a,u,o),this.text(h,t,n-4,c,u,o);else if("center"==u){r.font=c;var d=r.measureText(h).width;r.font=a;var f=r.measureText(l).width,p=t-(f+d)/2;this.text(l,p,n,a,"left",o),this.text(h,p+f+1,n-4,c,"left",o)}else this.text(l,t,n,a,u,o),this.text(h,t+r.measureText(l).width+1,n-5,c,u,o)},this.index=function(e,t,n,a,i,o,s){var l,h,u,d,f=i||m;return(l=e.toString().match(/(.*)([<>])(.*)/))?(h=l[1],u=l[3],d=l[2].search(/>/)>=0?-4:4,void("right"==f?(r.font=c,this.text(h,t-r.measureText(u).width-1,n,a,f,o,s),this.text(u,t,n+d,c,f,o,s)):"center"==f?(this.text(h,t,n,a,"right",o,s),this.text(u,t,n+d,c,"left",o,s)):(this.text(h,t,n,a,f,o,s),this.text(u,t+r.measureText(h).width+1,n+d,c,f,o,s)))):void this.text(l,t,n,a,i,o,s)},this.textwidth=function(e,t){return r.font=t||l,r.measureText(e).width},this.fillrect=function(e,t,n,a,i){r.fillStyle=i||h,r.fillRect(e,t,n,a)},this.strokerect=function(e,t,n,a,i,o){r.strokeStyle=i||h,r.lineWidth=o||u,r.strokeRect(Math.round(e)+.5,Math.round(t)+.5,n,a)},this.filldiamond=function(e,t,n,a,i){r.fillStyle=i||h,r.beginPath(),r.moveTo(e-n,t),r.lineTo(e,t-a),r.lineTo(e+n,t),r.lineTo(e,t+a),r.closePath(),r.fill()},this.roundedrect=function(e,t,n,a,i,o,s){r.strokeStyle=o||h,r.lineWidth=s||u,r.beginPath(),r.moveTo(e,t+i),r.lineTo(e,t+a-i),r.quadraticCurveTo(e,t+a,e+i,t+a),r.lineTo(e+n-i,t+a),r.quadraticCurveTo(e+n,t+a,e+n,t+a-i),r.lineTo(e+n,t+i),r.quadraticCurveTo(e+n,t,e+n-i,t),r.lineTo(e+i,t),r.quadraticCurveTo(e,t,e,t+i),r.stroke()},this.fillcircle=function(e,t,n,a){r.fillStyle=a||h,r.beginPath(),r.arc(Math.round(e)+.5,Math.round(t)+.5,n,0,2*Math.PI,!0),r.closePath(),r.fill()},this.fillellipsis=function(e,t,n,a,i){var o,s,l;r.fillStyle=i||h,o=a||1,s=n/2-.5,l=n/2-.5,r.save(),r.scale(1,1/o),r.beginPath(),r.arc(Math.round(e)+.5,Math.round(t*o)+.5,n,0,2*Math.PI,!0),r.closePath(),r.fill(),r.restore()},this.strokecircle=function(e,t,n,a,i){r.strokeStyle=a||h,r.lineWidth=i||u,r.beginPath(),r.arc(Math.round(e)+.5,Math.round(t)+.5,n,0,2*Math.PI,!0),r.closePath(),r.stroke()},this.filltriangle=function(e,t,n,a){r.fillStyle=a||h;var i=Math.sqrt(n);r.beginPath(),r.moveTo(e,t-i),r.lineTo(e+i,t+i),r.lineTo(e-i,t+i),r.closePath(),r.fill()},this.arc=function(e,t,n,a,i,o,s,l){r.strokeStyle=s||h,r.lineWidth=l||u,r.beginPath(),r.arc(e,t,n,a,i,o),r.arc(e,t,n,i,a,!o),r.closePath(),r.stroke()},this.gradient=function(e,t,n,r,a){var i=this.makegradient(e,n,t,n,a);t>e?this.fillrect(e,n,t-e,r,i):this.fillrect(t,n,e-t,r,i)},this.makegradient=function(e,t,n,a,i){var o=r.createLinearGradient(e,t,n,a);if("object"==typeof i&&i.constructor==Array)for(var s=0;s<i.length;s++)o.addColorStop(i[s].pos,i[s].col);return o},this.makeradialgradient=function(e,t,n,a,i,o,s){var l=r.createRadialGradient(e,t,n,a,i,o);if("object"==typeof s&&s.constructor==Array)for(var c=0;c<s.length;c++)l.addColorStop(s[c].pos,s[c].col);return l},this.image=function(e,t,n,a,i,o,s,l,c){var h;if(e&&-1!=(typeof e).search(/object|string/)){if(e.constructor==String)h=new Image,h.src=e;else{if(!e.src)return;h=e}o?r.drawImage(h,t,n,a,i,o,s,l,c):a?r.drawImage(h,t,n,a,i):r.drawImage(h,t,n)}},this.createpattern=function(e,t){return r.createPattern(e,t)},this.save=function(){r.save()},this.restore=function(){r.restore()},this.scale=function(e,t){r.scale(e,t)},this.rotate=function(e,t,n){var a,i,o;a=e?Math.PI*e/180:0,i=t||0,o=n||0,r.translate(i,o),r.rotate(a)},this.startp=function(e,t,n,a,i){r.fillStyle=n||h,r.strokeStyle=i||r.fillStyle,r.lineWidth=a||u,r.beginPath(),r.moveTo(e,t)},this.movep=function(e,t){r.lineTo(e,t)},this.arcp=function(e,t,n,a,i,o){r.arc(e,t,n,a,i,o)},this.endp=function(e,t,n){var a=n||!1;e&&t&&r.lineTo(e,t),r.closePath(),a&&r.fill(),r.stroke()},this.termp=function(e,t){e&&t&&r.lineTo(e,t),r.stroke()},this.clear=function(){r.clearRect(0,0,a,i)},this.Width=function(){return a},this.Height=function(){return i},g(t),a=n.width,i=n.height}function Round(e,t){return Math.round(Math.pow(10,t)*e)/Math.pow(10,t)}function sign(e){return e?0>e?-1:1:0}function prefix(e){return SI.hasOwnProperty(e)?SI[e]:1}function w2f(e){return 299792458/e}function e2f(e){return 0xdbea334f7fe3*e}function isNumber(e){return!isNaN(parseFloat(e))&&isFinite(e)}function isArray(e){return"[object Array]"===Object.prototype.toString.call(e)}function logError(e,t){console.log(e,t)}function px(e){return e+"px"}function Diag(e){var t,n,r,a,i,o={lo:1e6,hi:3e26,off:6,r:20},s={lo:5e-7,hi:5e5,off:6.5,r:12.5},l={x:160,y:54},c=SOBS.LEGEND,u="14px 'Trebuchet MS'",m="bold 20px 'Trebuchet MS'",d=SOBS.SCALEFONT,f="bold 20px 'Trebuchet MS'",p="#3c0",g="en",S={left:{l:0,t:"right",o:-2},right:{l:0,t:"left",o:1}};setParams=function(e){var r,a;for(r in e)switch(a=e[r],r){case"width":case"w":isNumber(a)&&(t=a);break;case"height":case"h":isNumber(a)&&(n=a);break;case"lang":g=a}},drawSpectrum=function(e,t){var n,a,i,o,s,l,h=t,u=[],m="#fff",d=SOBS.BARHEIGHT,p=SOBS.range.length-1;for(l=xscale(SOBS.range[0].f0),s=xscale(SOBS.range[p].f1)-l,n=0;n<SOBS.range.length;n++)a=xscale(SOBS.range[n].f0),i=xscale(SOBS.range[n].f1),3==n?(e.gradient(a+.5,i-.5,h,d,[{pos:0,col:SOBS.range[n].c0},{pos:.3,col:"#fc0"},{pos:.45,col:"#ff0"},{pos:.6,col:"#0f0"},{pos:.75,col:"#0cf"},{pos:1,col:SOBS.range[n].c1}]),u=u.concat([{pos:(a-l)/s,col:SOBS.range[n].c0},{pos:(a-l+2)/s,col:"#fc0"},{pos:(a-l+4)/s,col:"#ff0"},{pos:(a-l+6)/s,col:"#0f0"},{pos:(a-l+8)/s,col:"#0cf"}])):(e.gradient(a+1,i-1,h,d,[{pos:0,col:SOBS.range[n].c0},{pos:1,col:SOBS.range[n].c1}]),u.push({pos:(a-l)/s,col:SOBS.range[n].c0})),3==n?(o=d+17,m="#000"):(o=20,m="#fff"),e.text(SOBS.range[n].s,(i+a)/2,h+o,f,"center",m);e.text(SOBS.legend[g].bnd,S[c].l+10*S[c].o,h+o,SOBS.TEXTFONT,S[c].t,SOBS.TEXTCOL),r=e.makegradient(l,0,l+s,0,u)},drawXAxis=function(e,t,n,r){var a,i=t-2,s=1.2,l=xscale(o.lo),h=xscale(o.hi),u=SOBS.LINECOL,m=xscale(8e16);for(e.line(l,i,m-16,i,u,s),e.line(m+16,i,h,i,u,s),e.dashline(h,i,h+16,i,u,s,Cdraw.SDASH),e.dashline(l,i,l-16,i,u,s,Cdraw.SDASH),e.dashline(m-16,i,m+16,i,u,s,Cdraw.SDASH),a=2;a>=-8;a--)e.vline(xscale(w2f("1e"+a)),i-5,5,u,1);for(var a=3;12>=a;a++)e.vline(xscale(e2f("1e"+a)),i-5,5,u,1);for(a=0;a<SOBS.units.length;a++)"w"==SOBS.units[a].t?e.text(SOBS.units[a].n,xscale(w2f(SOBS.units[a].u)),i-10,d,"center"):e.text(SOBS.units[a].n,xscale(e2f(SOBS.units[a].u)),i-10,d,"center");for(r||e.text(SOBS.legend[g].wav,S[c].l+10*S[c].o,i-18,SOBS.TEXTFONT,S[c].t,SOBS.TEXTCOL),n&&(i+=n),e.line(l,i,h,i,u,s),e.dashline(h,i,h+16,i,u,s,Cdraw.SDASH),e.dashline(l,i,l-16,i,u,s,Cdraw.SDASH),a=6;26>=a;a++)e.vline(xscale("1e"+a),i,5,u,1),e.number("1e"+a,xscale("1e"+a),i+26,d,"center",SOBS.TEXTCOL);r||e.text(SOBS.legend[g].freq,S[c].l+10*S[c].o,i+25,SOBS.TEXTFONT,S[c].t,SOBS.TEXTCOL)},drawYAxis=function(n,r){var o,l,h,u,m,p,y,w=SOBS.LINECOL;if("line"==e&&(n.text(SOBS.legend[g].fut,t+32,a+12,f,"right",SOBS.TEXTCOL),n.text(SOBS.legend[g].grnd,t+32,i+34,f,"right",SOBS.TEXTCOL)),"res"==e){for(m=S[c].l,p=S[c].t,y=S[c].o,l=yscale(s.lo),h=yscale(s.hi),u=m,n.line(u,l,u,h,w,1),o=-6;6>o;o++)n.hline(u,yscale("1e"+o),5*y,w,1),n.number("1e"+o,u+7*y,yscale("1e"+o)+6,d,p);u+=35*y,"left"==c?(n.vtext("Angular Resolution [arcsec]",u-40,(h+l)/2-10,SOBS.TEXTFONT,"center",SOBS.TEXTCOL),n.text("10Â°",u,yscale(36e3)+6,d,p),n.hline(u+6,yscale(36e3),14,w,1),n.text(" 1Â°",u,yscale(3600)+6,d,p),n.hline(u+6,yscale(3600),14,w,1),n.text(" 1â€²",u,yscale(60)+6,d,p),n.hline(u+6,yscale(60),14,w,1),n.text(" 1â€³",u,yscale(1)+6,d,p),n.hline(u+6,yscale(1),14,w,1),n.text(" 1mas",u,yscale(.001)+6,d,p),n.hline(u+6,yscale(.001),10,w,1),n.text("1Î¼as",u,yscale(1e-6)+6,d,p),n.hline(u+6,yscale(1e-6),10,w,1)):(n.vtext("Angular Resolution [arcsec]",u+70,(h+l)/2-10,SOBS.TEXTFONT,"center",SOBS.TEXTCOL),n.text("10Â°",u+6,yscale(36e3)+6,d,p),n.hline(u-12,yscale(36e3),14,w,1),n.text(" 1Â°",u+6,yscale(3600)+6,d,p),n.hline(u-12,yscale(3600),14,w,1),n.text(" 1â€²",u+6,yscale(60)+6,d,p),n.hline(u-12,yscale(60),14,w,1),n.text(" 1â€³",u+6,yscale(1)+6,d,p),n.hline(u-12,yscale(1),14,w,1),n.text(" 1mas",u+6,yscale(.001)+6,d,p),n.hline(u-12,yscale(.001),14,w,1),n.text("1Î¼as",u+6,yscale(1e-6)+6,d,p),n.hline(u-12,yscale(1e-6),14,w,1))}},drawAbsoption=function(t,n){var r,a,i=n,s=SOBS.BARHEIGHT+4,l=xscale(o.hi)-8,h=xscale(o.lo)-2,u=t.makegradient(0,i+s,0,i,[{pos:0,col:"#c0b7df"},{pos:1,col:"#9999cc"}]);t.fillrect(h,i-1,l-h,s+2,u),u=t.makegradient(0,i+s,0,i,[{pos:0,col:"#999"},{pos:1,col:"#555"}]),t.startp(l,i+s,u),t.movep(l,i);for(var r=0;r<SOBS.absorp.length;r++)t.movep(xscale(w2f(1e-6*SOBS.absorp[r].f)),i+s*(1-SOBS.absorp[r].a));t.movep(h,i),t.movep(h,i+s),t.endp(l,i+s,!0),t.text(SOBS.legend[g].abs,S[c].l+10*S[c].o,i+14,SOBS.TEXTFONT,S[c].t,SOBS.TEXTCOL),i=i+s-6,t.text(SOBS.legend[g].ion,xscale(35e5),i,d,"center","#fff"),t.text(SOBS.legend[g].h2o,xscale(3e12),i,d,"center","#fff"),t.text(SOBS.legend[g].o23,xscale(1e20),i,d,"center","#fff"),a="line"==e?22:32,t.text("0",l+a,i+0,d,"right","","top",col),t.text("100",l+a,i-s+8,d,"right",null,null,col)},drawScope=function(e,t){var n,r,a,i,o,s=(SOBS.TEXTFONT,"#ad6");s=getColor(t),n=t.d&&t.px?drawScopeDL(e,t,s):drawScopeL(e,t,s),t.hasOwnProperty("c")&&null!=t.c&&(r="center",a=(n.x0+n.x1)/2,i=-1!=t.c.search(/b/)?n.y1:(n.y1+n.y0)/2,-1!=t.c.search(/r/)?(r="left",a=n.x1+4,i=n.y1-9):-1!=t.c.search(/l/)&&(r="right",a=n.x0-4,i=n.y0-9),-1!=t.c.search(/n/)&&(o=t.n,-1!=t.c.search(/i/)&&(o+=" "+t.i),-1!=t.c.search(/p/)&&(o=t.p),-1!=t.c.search(/v/)?-1!=t.c.search(/t/)?e.vtext(o,a+5.5,i-5.5,m,r,p,50):e.vtext(o,a-14.5,i+14.5,m,r,p,50):-1!=t.c.search(/t/)?e.text(o,a,i-2.5,m,r,p):e.text(o,a,i+14.5,m,r,p)))},drawScopeDL=function(e,t,n){var r,a,i,o=-1,s=-1,l=-1,c=-1,h={};for(a=(t.f1-t.f0)/(xscale(t.f1)-xscale(t.f0))*3,r=t.f0;r<=t.f1;r+=a)i=getRes(t,r),o=xscale(r),s=yscale(i),r==t.f0&&(h.x0=o,h.y0=s),-1!=l&&-1!=c&&e.line(o,s,l,c,n,3.7),l=o,c=s;return h.y1=c,h.x1=l,h},drawScopeL=function(e,t,n){var r=-1,a=-1,i=-1,o=-1;return r=xscale(t.f0),i=xscale(t.f1),a=yscale(t.r0),o=t.r1?yscale(t.r1):a,e.line(r,a,i,o,n,2.5),{x0:r,y0:a,x1:i,y1:o}},drawMission=function(e,t,n){var r,a,i,o,s,l;return t.hasOwnProperty("c")&&null!=t.c?(r=xscale(t.fl),a=xscale(t.fh),o=n+SOBS.BARHEIGHT+3,-1!=t.c.search(/l/)?(l="right",i=r-16):(l="left",i=a+16),-1!=t.c.search(/n/)&&e.text(t.n,i,o+6,SOBS.TEXTFONT,l,SOBS.TEXTCOL),i=-1!=t.c.search(/l/)?a+4+t.x:r-4+t.x,t.hasOwnProperty("img")&&null!=t.img&&(s=t.hasOwnProperty("sc")&&null!=t.sc?t.sc:1,drawImg(e,t.img,s,i,n+6+t.y,l)),n+SOBS.BARHEIGHT+6):n},drawImg=function(e,t,n,r,a,i){var o,s,l=50*n;s="right"==i?4:-l-4,o=new Image,o.onload=function(){e.image(this,r+s,a,l,this.height/this.width*l)},o.src=t},drawLine=function(e,t,n){var r,a,i;return t.hasOwnProperty("c")&&null!=t.c?(a=xscale(t.f0),r=xscale(t.f1>o.hi?o.hi:t.f1),h=n,i=getColor(t),e.line(a,h,r,h,i,4),e.vline(a,h-7,7,i,1.2),t.f1<=o.hi?e.vline(r,h-7,7,i,1.2):e.dashline(r,h,r+16,h,i,4,Cdraw.SDASH),t.hasOwnProperty("p")&&null!=t.p&&-1==t.c.search(/x/)?e.text(t.p+" "+t.i,(r+a)/2,h+4,u,"center",SOBS.TEXTCOL,"top"):t.hasOwnProperty("i")&&null!=t.i&&-1==t.c.search(/x/)&&e.text(t.i,(r+a)/2,h+4,u,"center",SOBS.TEXTCOL,"top"),-1!=t.c.search(/y/)?n+ +SOBS.BARHEIGHT:n):n},xscale=function(e){var n=e;return e>o.hi&&(n=o.hi),e<o.lo&&(n=o.lo),(Math.LOG10E*Math.log(n)-o.off)*t/o.r},yscale=function(e){var t=e;return e>s.hi&&(t=s.hi),e<s.lo&&(t=s.lo),n-(Math.LOG10E*Math.log(t)+s.off)*n/s.r},getRes=function(e,t,n){var r=75440684077500/t/e.d;return n===!0?r:Math.sqrt(r*r+Math.pow(e.px,2))},getColor=function(e){return col=SOBS.FUTURE&&"pl"==e.st?"#bba":"g"==e.st?"#778":"sol"==e.pur?"#ff0":SOBS.mtype.hasOwnProperty(e.tp)?SOBS.mtype[e.tp].col:r,col},this.draw=function(r,s,h,m,f){var p,g,y=0,w="";if(n=f,r.setheight(f+2*l.y+18),t=m,S.left.l=xscale(o.lo),S.right.l=xscale(o.hi),r.setwidth(m+l.x+64),r.setexpfont(u),r.setfont(d),r.setcolor(SOBS.TEXTCOL),e=s,"left"==c?(r.setviewport(l.x,l.y),r.fillrect(-l.x-10,-l.y-10,t+250,n+120,SOBS.BGCOL)):(r.setviewport(30,l.y),r.fillrect(-30,-l.y-10,t+l.x+250,n+120,SOBS.BGCOL)),"res"==e){for(g=y,drawSpectrum(r,g+1),drawXAxis(r,g,n+SOBS.BARHEIGHT-6),drawYAxis(r,g),p=0;p<h.length;p++)-1!=h[p].st.search(/o|g/)&&drawScope(r,h[p]);drawAbsoption(r,n-14)}if("line"==e){for(y=10,g=y,drawSpectrum(r,g),g+=SOBS.BARHEIGHT,p=0;p<h.length;p++)-1!=h[p].st.search(/o/)&&(h[p].n!=w&&(g=drawMission(r,h[p],g),w=h[p].n),g=drawLine(r,h[p],g));for(g+=5*SOBS.BARHEIGHT,a=g,p=0;p<h.length;p++)-1!=h[p].st.search(/pl/)&&(h[p].n!=w&&(g=drawMission(r,h[p],g),w=h[p].n),g=drawLine(r,h[p],g));for(g+=2*SOBS.BARHEIGHT,drawAbsoption(r,g),g+=SOBS.BARHEIGHT+6,i=g,p=0;p<h.length;p++)-1!=h[p].st.search(/g/)&&(h[p].n!=w&&(g=drawMission(r,h[p],g),w=h[p].n),drawLine(r,h[p],g));drawXAxis(r,y,g+SOBS.BARHEIGHT-12),drawXAxis(r,a-2*SOBS.BARHEIGHT,4),drawYAxis(r,y)}}}Cdraw.SOLID=[1],Cdraw.DASH=[4,4],Cdraw.DOT=[1.5,3.5],Cdraw.LDASH=[8,8],Cdraw.SDASH=[2,4],Cdraw.DASHDOT=[4,4,1,4];var Trig={sinh:function(e){return(Math.pow(Math.E,e)-Math.pow(Math.E,-e))/2},cosh:function(e){return(Math.pow(Math.E,e)+Math.pow(Math.E,-e))/2},tanh:function(e){return 2/(1+Math.exp(-2*e))-1},asinh:function(e){return Math.log(e+Math.sqrt(e*e+1))},acosh:function(e){return Math.log(e+Math.sqrt(e*e-1))},normalize0:function(e){return(e+3*Math.PI)%(2*Math.PI)-Math.PI},normalize:function(e){return(e+2*Math.PI)%(2*Math.PI)},deg2rad:function(e){return e*Math.PI/180},hour2rad:function(e){return e*Math.PI/12},rad2deg:function(e){return 180*e/Math.PI},rad2hour:function(e){return 12*e/Math.PI},PI:Math.PI,PI2:2*Math.PI,PI_2:Math.PI/2},SI={a:1e-18,f:1e-15,p:1e-12,n:1e-9,u:1e-6,"Î¼":1e-6,m:.001,c:.01,k:1e3,M:1e6,G:1e9,T:1e12,P:1e15,E:1e18},UI=UI||{width:0,height:0,boxwidth:0,bevel:0,iscancelled:!1,scale:1,left:0,right:0};UI.vanish=function(e){var t,n;for(n=document.querySelectorAll(e===!1?".infoPopup":".infoBox, .infoPopup"),t=0;t<n.length;t++)n[t].style.opacity=0;setTimeout(UI.shift,1e3)},UI.shift=function(){var e,t;for(t=document.querySelectorAll(".infoBox, .infoPopup"),e=0;e<t.length;e++)"0"===t[e].style.opacity&&(t[e].style.top=px(-9999))},UI.wait=function(e,t,n){var r=document.getElementById("waitmsg");r&&(e?(r.style.top=px(t),r.style.left=px(n),r.style.display="block",UI.iscancelled=!1):("block"==r.style.display&&(UI.iscancelled=!0),r.style.display="none"))},UI.cancelled=function(){return UI.iscancelled},UI.Width=function(){var e=0;return e=document.documentElement.clientWidth?document.documentElement.clientWidth:window.innerWidth,(0===e||700>e)&&(e=700),e},UI.Height=function(e){return isNumber(e)&&(UI.height+=e),UI.height},UI.show=function(e,t){var n,r,a,i=(e||window.event,UI.getBoxPos(e)),o=t||this;return r=o.offsetTop+o.clientHeight+2,n=o.id.match(/^(sbo|rings|moons|info)(.+)/),null!==n&&(a=document.getElementById(n[2]+n[1])),a||UI.cancelled()?UI.wait(!1):(UI.wait(!0,r,i.c),window.setTimeout(function(){UI.show(e,o)},500)),a?(1==a.style.opacity?(UI.vanish(),parseInt(a.style.top)!=r&&window.setTimeout(function(){UI.show(e,o)},250)):(UI.vanish(),a.style.left=px(i.l),a.style.top=px(r),a.style.opacity=1,UI.Scroll.set(a)),!1):!1},UI.go=function(){var e,t,n=this;e=n.id.match(/^(leg|info)(.+)/),null!==e&&(UI.vanish(),t=document.getElementById("info"+e[2]),UI.Scroll.top(t))},UI.Scroll=new function(){var e,t,n,r,a=25,i=function(){return window.pageYOffset||document.documentElement.scrollTop},o=function(){return window.innerHeight||document.documentElement.clientHeight},s=function(){return r/n},l=function(){return r+=a,e-t/2*(Math.cos(Math.PI*s())+1)},c=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;this.set=function(s){var l,h,u;s&&(u="string"==typeof s?document.getElementById(s):s,l=u.getBoundingClientRect(),h=o(),l.bottom<h||(t=l.height>h?l.top:l.bottom-h,0>=t||(e=i()+t,n=Math.round(t/a)*a*2,a>n&&(n=a),r=0,c(this.move))))},this.top=function(o){var s,l;o&&(l="string"==typeof o?document.getElementById(o):o,s=l.getBoundingClientRect(),t=s.top,e=i()+t,n=Math.round(t/a)*a*2,n>2e3&&(n=Math.round(Math.pow(t,.85)/a)*a*2),a>n&&(n=a),r=0,c(this.move))},this.move=function(){var t=l();Math.abs(e-t)<1||(window.scrollTo(0,t),n>r&&c(UI.Scroll.move))}},UI.getBoxPos=function(e){var t,n,r=UI.boxwidth,a=UI.Width(),i=e||window.event;return n=i&&i.clientX?i.clientX:a/2,t=n-r/2+5,0>t&&(t=8),t>a-r-32&&(t=a-r-32),n-=99,8>n&&(n=8),n>a-232&&(n=a-232),{l:t,c:n}},UI.showBox=function(e){var t=document.getElementById(e);return t&&UI.show(null,t),!1},UI.showImg=function(e){var t,n,r,a=e||window.event;if(this.id)for(t=this.childNodes,n=0;n<t.length;n++)if("img"==t[n].nodeName.toLowerCase()){"mouseout"==a.type?t[n].style.top=px(-9999):"mouseover"==a.type&&(r=-t[n].height/2+8,t[n].style.top=px(r));break}},UI.Scale={oldsize:{w:0,h:0,t:0,l:0},dist:function(e,t){return e.a?parseFloat(e.a)*t:void 0},image:function(e,t){var n,r,a,i;return a=t||1,e?e.eqrad&&0!==e.scale?(r=e.eqrad<1?1:e.eqrad,n=5*Math.pow(r*e.scale,.9)/UI.scale*a,5>n&&(n=5),i=0===e.img.width?1:e.img.height/e.img.width,{w:n,h:n*i}):{w:e.img.width,h:e.img.height}:void 0},time:function(e,t){var n,r=t?t-UI.bevel:1;return n=Math.round((e.valueOf()-UI.left)/(UI.right-UI.left)*r),t&&(n+=UI.bevel),n},enlarge:function(e){var t,n,r,a,i=e||window.event;-1!=i.target.id.search(/pic/)?r=i.target:(n=i.target.parentNode.id,n&&""!==n||(n=i.target.parentNode.parentNode.id),n=n.replace(/line/,"pic"),r=document.getElementById(n)),r&&(a=r.height/r.width,120==parseInt(r.style.width)?(r.style.width=px(UI.Scale.oldsize.w),r.style.height=px(UI.Scale.oldsize.h),r.style.top=px(UI.Scale.oldsize.t),r.style.left=px(UI.Scale.oldsize.l),r.style.zIndex=300,UI.Scale.oldsize={w:0,h:0,t:0,l:0}):(UI.Scale.oldsize={w:parseFloat(r.style.width),h:parseFloat(r.style.height),t:parseFloat(r.style.top),l:parseFloat(r.style.left)},UI.Scale.oldsize.w<120?(r.style.cursor="url('"+Common.symbols.zoomin.src+"'), auto",r.style.width=px(120),r.style.height=px(120*a),t=UI.Scale.oldsize.t+UI.Scale.oldsize.h/2-120*a/2,4>t&&(t=4),t>244-120*a&&(t=244-120*a),r.style.top=px(t),t=UI.Scale.oldsize.l+UI.Scale.oldsize.w/2-60,4>t&&(t=4),t>UI.boxwidth-124&&(t=UI.boxwidth-124),r.style.left=px(t),r.style.zIndex=301):r.style.cursor="url('"+Common.symbols.nozoom.src+"'), auto"),n||(n=r.id.replace(/pic/,"line"),UI.showEntry(n)),i.stopPropagation())}},UI.toggle=function(){var e=this,t=e.nextSibling;t&&("120px"!=t.style.maxHeight?(t.firstChild.style.display="inline-block",t.style.maxHeight=px(120),window.setTimeout(function(){UI.View.set(e)},600)):(t.style.maxHeight=px(0),t.firstChild.style.display="none"))},UI.showRing=function(){if(this.id){var e=this.id.replace(/pic/,"line");UI.showEntry(e)}},UI.showEntry=function(e){var t,n=document.getElementById(e);if(n)if(-1==n.style.backgroundColor.search(/rgb/))n.style.background="rgb(255, 255, 204)",n.nextSibling.firstChild.style.display="inline-block",n.nextSibling.style.maxHeight=px(120),window.setTimeout(function(){UI.View.set(n)},600);else{if(n.style.background="transparent",t=e.match(/(ring.{3}|moon.{3}|sbo.)/),null!==t&&(t="lnk"+t[1],-1!=document.getElementById(t).innerHTML.search(/Hide/)))return;n.nextSibling.firstChild.style.display="none",n.nextSibling.style.maxHeight=px(0)}},UI.View=new function(){var e,t,n,r,a,i,o=30,s=function(){return i/a},l=function(){return i+=o,t-n/2*(Math.cos(Math.PI*s())+1)};this.set=function(s){if(s){if(t=null,e=s.parentNode,r=e.firstChild.offsetTop,e.scrollHeight>e.clientHeight&&(s.offsetTop+s.clientHeight+s.nextSibling.clientHeight>e.scrollTop+e.clientHeight&&(t=s.offsetTop+s.clientHeight+s.nextSibling.clientHeight-e.clientHeight-r),s.offsetTop<e.scrollTop&&(t=s.offsetTop-r)),null===t&&e.parentNode.parentNode)return void UI.Scroll.set(e.parentNode.parentNode);n=t-e.scrollTop,a=Math.round(Math.abs(n)/o)*o*2,o>a&&(a=o),i=0,window.setTimeout(this.move,o)}},this.move=function(){var t,n=l();e.scrollTop=n,t=i>=a?0:o,t>0?window.setTimeout(UI.View.move,o):e.parentNode.parentNode&&UI.Scroll.set(e.parentNode.parentNode)}},UI.all=function(){var e,t=document.getElementsByClassName("detPanel"),n=-1==this.innerHTML.search(/Hide/),r=this.id.replace(/lnk/,""),a=null;if(n){for(e=0;e<t.length;e++)t[e].id&&-1!=t[e].id.search(r)&&(t[e].firstChild.style.display="inline-block",t[e].style.maxHeight=px(120),a=e);this.innerHTML="Hide details",a&&t[a].parentNode.parentNode.parentNode&&UI.Scroll.set(t[a].parentNode.parentNode.parentNode)}else{for(e=0;e<t.length;e++)t[e].id&&-1!=t[e].id.search(r)&&(t[e].firstChild.style.display="none",t[e].style.maxHeight=px(0));this.innerHTML="Show all details"}return!1},UI.isFullScreen=function(){return document.fullScreenElement&&null!==document.fullScreenElement||document.mozFullScreen||document.webkitIsFullScreen},UI.toggleFullScreen=function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)};var Create={br:function(e){var t=document.createElement("br");return e&&e.appendChild(t),t},text:function(e,t){var n=document.createTextNode(t);return e&&e.appendChild(n),n},bold:function(e,t){var n=document.createElement("b");return n.appendChild(document.createTextNode(t)),e&&e.appendChild(n),n},div:function(e,t,n,r){var a=document.createElement("div");return t&&(a.className=t),n&&(a.id=n),r&&"object"==typeof r&&(r.hasOwnProperty("t")&&(a.style.top=px(r.t)),r.hasOwnProperty("l")&&(a.style.left=px(r.l)),r.hasOwnProperty("h")&&(a.style.height=px(r.h)),r.hasOwnProperty("w")&&(a.style.width=px(r.w))),e&&e.appendChild(a),a},span:function(e,t,n,r){var a,i=document.createElement("span");return n&&(i.className=n),r&&(i.id=r),t&&(a=t.n.toString(),-1!=a.search(/\d/)&&(a=this.number(a)),i.innerHTML=a,t.l&&(i.title=t.l,t.u||(i.style.cursor="help")),t.c&&(i.style.color=t.c)),e&&e.appendChild(i),i},a:function(e,t,n){var r;if(t.n||t.u)return t.u?(r=document.createElement("a"),n&&(r.className=n),this.span(r,t,n),r.href=t.u,t.t&&(r.target=t.t),e&&e.appendChild(r),r):this.span(e,t,n)},img:function(e,t,n,r){if(t&&"object"==typeof t){var a=document.createElement("img");return n&&(a.className=n),r&&(a.id=r),a.src=t.i,t.hasOwnProperty("n")&&(a.title=t.l?t.l+" ("+t.n+")":t.n),t.x&&(t.hasOwnProperty("x")&&(a.style.left=px(t.x)),t.hasOwnProperty("y")&&(a.style.top=px(t.y)),t.hasOwnProperty("h")&&(a.style.height=px(t.h)),t.hasOwnProperty("w")&&(a.style.width=px(t.w))),e&&e.appendChild(a),a}},aimg:function(e,t,n){var r;if(t){if(!t.u&&!t.i)return this.span(e,t,n);if(t.i?(r=document.createElement("img"),r.src=t.i,n&&(r.className=n),r.title=t.n||t.l||!t.u?t.l?t.l+" ("+t.n+")":t.n:t.u):r=this.span(null,t,n),t.u){var a=document.createElement("a");return a.href=t.u,t.t&&(a.target=t.t),n&&(a.className=n),a.appendChild(r),e&&e.appendChild(a),a}return e&&e.appendChild(r),r}},table:function(e,t,n){var r=document.createElement("table");return t&&(r.className=t),n&&(r.id=n),e&&e.appendChild(r),r},thead:function(e,t){var n=document.createElement("thead");return t&&(n.className=t),e&&e.appendChild(n),n},tbody:function(e,t){var n=document.createElement("tbody");return t&&(n.className=t),e&&e.appendChild(n),n},tr:function(e,t,n){var r=document.createElement("tr");return t&&(r.className=t),n&&(r.id=n),e&&e.appendChild(r),r},td:function(e,t,n){var r=document.createElement("td");return n&&(r.className=n),t&&(t.i&&this.symbol(r,t.i,"missionFlag"),this.span(r,t,n)),e&&e.appendChild(r),r},field:function(e,t,n,r,a,i,o){var s,l,c;if(r===!0&&this.br(e),t&&"-"!=t){if(r!==!0&&r!==!1&&this.br(e),this.span(e,Common.names.find("t"+n),"category"),isArray(t))for(c=a||", ",s=this.span(e,null,i,o),l=0;l<t.length;l++)l>0&&this.text(s,c),this.span(s,t[l]);else s=t.hasOwnProperty("n")?this.span(e,t,i,o):this.span(e,{n:t},i,o);return s}},closex:function(e){var t=this.a(e,{n:"x",u:"javascript:UI.vanish()"},"close");t.style.left=px(SSEH.BOXWIDTH-3),t.title="Close box"},symbol:function(e,t,n,r){var a,i,o=this.div(e,n);return i=Common.sprites[t],a=r||1,o.title=i.n,o.style.background="url("+Common.symbols.sprite.src+") "+-i.x/a+"px "+-i.y/a+"px / "+px(240/a),o},asymbol:function(e,t,n,r){var a,i,o;if(t)return Common.sprites.hasOwnProperty(t.k)?(o=t.u?this.a(e,{u:t.u,t:"_blank",n:"Â "},n):this.div(e,n),i=Common.sprites[t.k],a=r||1,o.title=-1!=t.k.search(/ext|tw|globe/)?t.u:i.n,o.style.background="url("+Common.symbols.sprite.src+") "+-i.x/a+"px "+-i.y/a+"px / "+px(240/a),o):this.a(e,t,n+"W")},number:function(e){var t=e.replace(/(\d)[eE]\+?(-?[\d]+)/g,"$1Ã—10<sup>$2</sup>");return t=t.replace(/\^\+?(-?[\d]+)/g,"<sup>$1</sup>")}},Read={string:function(e,t){return e?1==e.length?{n:e[0]}:e[0].length<=3&&!t?{n:e[1]+" ("+e[0]+")"}:{n:e[0],l:e[1]}:void 0},data:function(e){var t,n,r=[];if(!e)return[];if(t=e.split(";"),t.length<1)return[];for(n=0;n<t.length;n++)r[n]=t[n].split(":");return r},url:function(e,t){var n,r;if(e)return e.length>1?(n=e[1],r=Common.names.find(e[0],!1)):t?(n=e[0],r=Common.names.find(t)):(n=e[0],r=Common.names.find("More")),-1==n.search(/^[\.\/]/)&&(n="http://"+n,r.t="_blank"),r.u=n,("weather"==e[0]||"haz"==e[0])&&(r.k=e[0]),"tw"==e[0]&&(r.n="@"+r.u.replace(/.*\//,"")),r}};String.prototype.toCommaString=function(){var e=this.split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")},Number.prototype.toCommaString=function(){var e=this.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")},String.prototype.toScience=function(){var e,t,n="";return e=this.match(/(^\D+)/),null!==e?(n=e[1],t=parseFloat(this.substring(n.length)).toPrecision(4)):t=parseFloat(this).toPrecision(4),t=t.replace(/\.?0+[eE]/,"e"),n+t},Number.prototype.toScience=function(){var e=this.toPrecision(4);return e=e.replace(/\.?0+[eE]/,"e")},Array.prototype.unique=function(e){return function(){return this.filter(e)}}(function(e,t,n){return n.indexOf(e,t+1)<0}),Date.prototype.add=function(e,t){var n,r=this.valueOf();if(e){switch(n=t||"d"){case"y":case"yr":r+=31556926080*e;break;case"m":case"mo":r+=26298e5*e;break;case"d":case"dy":r+=864e5*e;break;case"h":case"hr":r+=36e5*e;break;case"n":case"mn":case"mon":r+=6e4*e;break;case"s":case"sec":r+=1e3*e;break;case"ms":r+=e}return new Date(r)}},Date.prototype.diff=function(e,t){var n,r;if(e){switch(n=e.valueOf()-this.valueOf(),r=t||"d"){case"y":case"yr":n/=31556926080;break;case"m":case"mo":n/=26298e5;break;case"d":case"dy":n/=864e5;break;case"h":case"hr":n/=36e5;break;case"n":case"mn":n/=6e4;break;case"s":case"sec":n/=1e3;break;case"ms":}return n}},Date.prototype.toISOString||(Date.prototype.toISOString=function(){function e(e){return 10>e?"0"+e:e}return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())}),Date.prototype.frac=function(){return(this.getHours()+this.getTimezoneOffset()/60+this.getMinutes()/60+this.getSeconds()/3600)/24};var Parse={unit:function(e){if(e)switch(e){case"kN":case"km":case"m":case"e":case"kg":return Common.SPC+e;case"au":return Common.SPC+e.toUpperCase();case"deg":case"i":return"Â°"}},distance:function(e,t){var n="",r=null;if(e=e.toString(),r=e.match(/([\-\d\.e\^]*\d)(mi|km|m|au|deg|i|e)?/),null!==r)switch(r[2]){case"m":n=r[1].toCommaString()+Common.SPC+"m";break;case"km":n=r[1].toCommaString()+Common.SPC+"km";break;case"mi":n=Math.round(1.609344*r[1]).toCommaString()+Common.SPC+"km";break;case"au":n=r[1]+Common.SPC+"AU";break;case"deg":case"i":n=r[1]+"Â°";break;case"e":n=r[1]+"";break;case void 0:var a=Common.names.findRadius(t);n=a?Math.round((r[1]-1)*a).toCommaString()+Common.SPC+"km":r[1].toCommaString();break;default:return""}return n},orbit:function(e,t){var n,r,a="",i=null;for(i=e.split("x"),i.length>1&&-1==i[0].search(/[a-z]/i)&&-1!=i[1].search(/[a-z]/i)&&(r=i[1].match(/(km|au)/),null!==r&&(i[0]+=r[1])),n=0;n<i.length;n++)""!==a&&(a+=Common.TSPC+"Ã—"+Common.TSPC),a+=this.distance(i[n],t);
return r=a.match(/(km|au)/gi),null!==r&&r.length>1&&(a=a.replace(/^(\-?\d+)\s?km|\s?au/i,"$1")),a},elements:function(e,t){var n,r,a,i,o,s,l;if(e.a)return t&&"aei"==t?(a=this.distance(e.a),e.e&&""!==e.e&&(a+=Common.TSPC+"Ã—"+Common.TSPC+e.e),e.i&&""!==e.i&&(a+=Common.TSPC+"Ã—"+Common.TSPC+this.distance(e.i+"i")),a):e.e?(l=e.a.match(/([\d\.e]+)\s?(km|au)/),null===l?e.a:(n=this.unit(l[2]),r=-1!=n.search(/km/)?0:3,a=parseFloat(l[1]),i=parseFloat(e.e),o=Round(a*(1-i),r),s=Round(a*(1+i),r),o.toCommaString()+Common.TSPC+"Ã—"+Common.TSPC+s.toCommaString()+n+Common.TSPC+"Ã—"+Common.TSPC+this.distance(e.i+"i"))):e.a},diameter:function(e){var t=null;if(e||""!==e)return-1!=e.search(/\//)?(t=e.split("/"),t[0].toCommaString().replace(/(km)/,Common.SPC+"$1/")+t[1]):-1!=e.search(/x/)?e.replace(/x/g,Common.TSPC+"Ã—"+Common.TSPC).replace(/(km)/,Common.SPC+"$1"):e.toCommaString().replace(/(km)/,Common.SPC+"$1")},rad:function(e){var t,n=0,r=null;if(e||""!==e){if(-1!=e.search(/x/)){for(r=e.split("x"),t=0;t<r.length;t++)n+=parseFloat(r[t])/2;n/=r.length}else if(-1!=e.search(/\.\./)){for(r=e.split(".."),t=0;t<r.length;t++)n+=parseFloat(r[t])/2;n/=r.length}else-1!=e.search(/\//)?(r=e.split("/"),n=parseFloat(r[0])/2,n+=n*parseFloat(r[1])/4):n=parseFloat(e)/2;return n}},range:function(e){var t="",n=null;if(e||""!==e)return n=e.split(".."),t=parseFloat(n[0]).toCommaString(),n.length>1&&(t+="â€¦"+parseFloat(n[1]).toCommaString()),t+"km"},band:function(e){var t,n,r,a="";if(e||""!==e)return t=e.match(/([a-zA-Z]+)/),r=null!==t?t[1]:"Hz",n=e.split(".."),a=parseFloat(n[0]).toCommaString(),n.length>1&&(a+="â€¦"+parseFloat(n[1]).toCommaString()),a+"km"},thickness:function(e){var t,n="km",r="",a=null;if(e&&""!==e){for(a=e.split(".."),t=0;t<a.length;t++)t>0&&(r+="â€¦"),parseFloat(a[t])<.1?(r+=Math.round(1e3*parseFloat(a[t])),n="m"):r+=-1!=a[t].search(/[eE]/)?a[t]:parseFloat(a[t]).toCommaString();return r+Common.SPC+n}},thick:function(e){if(!e||""===e)return.001;var t,n=0,r=e.split("..");for(t=0;t<r.length;t++)n+=parseFloat(r[t]);return n/=r.length},rotation:function(e){var t;if(e&&""!==e){switch(e.toLowerCase()){case"s":t=Common.names.find("sync").n;break;case"c":t=Common.names.find("chao").n;break;default:t=Parse.time(e)}return t}},velocity:function(e){var t="",n=null;if(e){if(n=e.match(/([\d\.]+)(kms)?/),null!==n)switch(n[2]){case"kms":t=n[1]+Common.SPC+"km/s";break;case void 0:break;default:return""}return t}},position:function(e){var t="Â°",n=null;return n=e.match(/([\d\.]+)([NS])\,([\d\.]+)([EW])/i),null!==n?n[1]+t+n[2]+", "+n[3]+t+n[4]:(n=e.match(/([\d\.]+)([EW])\,([\d\.]+)([NS])/i),null!==n?n[3]+t+n[4]+", "+n[1]+t+n[2]:(n=e.match(/([\d\.]+)([NSEW])/),null!==n?n[1]+t+n[2]:void 0))},pos:function(e){var t,n=null,r=null;if(e)return t=e.match(/([\d\.]+)([NS])\,([\d\.]+)([EW])/i),null!==t?(n=parseFloat(t[1]),"S"==t[2]&&(n=-n),r=parseFloat(t[3]),"W"==t[4]&&(r=-r)):(t=e.match(/([\d\.]+)([EW])\,([\d\.]+)([NS])/i),null!==t&&(n=parseFloat(t[3]),"S"==t[4]&&(n=-n),r=parseFloat(t[1]),"W"==t[2]&&(r=-r))),null!==n&&null!==r?(r>180&&(r-=360),-180>r&&(r+=360),n+","+r):void 0},date:function(e,t){var n,r,a="",i=null;if(e){if(-1==e.search(/^l/)){i=e.split("..");for(var o=0;o<i.length;o++)o>0&&(a+="â€¦"),a+=i[o]}else if(i=e.match(/^l\+([\d\.\?]+)(\w+)?/),null!==i)if(t)-1!=i[1].search(/\?/)?a="?":(r=t.add(i[1],i[2]),a=r.toISOString().slice(0,7));else{switch(i[2]){case"hr":n="hr";break;case"dy":n="dy";break;case"mo":n="mon";break;case"yr":n="yr";break;default:n=""}a="L+"+i[1]+Common.SPC+n}return a}},dt:function(e,t){var n;if(e){if(t&&-1!==e.search(/^l/i))return n=e.split(/[\+\u202f]/),t.add(n[1],n[2]);if(n=e.split("."),!(n.length<1)&&(n=n[0].split("-"),n[0]=n[0].replace(/\D/g,""),n[0]))return n[1]=n[1]?n[1].replace(/\D/g,""):"1",n[2]=n[2]?n[2].replace(/\D/g,""):"1",new Date(n[0],n[1]-1,n[2])}},comp:function(e){var t,n,r,a,i="";if(e&&""!==e){for(r=e.split("+"),t=0;t<r.length;t++)a=r[t].split(":"),"poro"==a[0]?(a[0]="Porosity",n=";"+Common.SPC):"dust"==a[0]?(a[0]="Dust",n=";"+Common.SPC):"core"==a[0]?(a[0]="Core",n=";"+Common.SPC):n=Common.SPC+"+"+Common.SPC,t>0&&(i+=n),i+=a.length>1?a[0]+":"+Common.SPC+a[1]+"%":a[0];return i}},atm:function(e){var t="";return e.atm&&""!==e.atm&&(t=this.comp(e.atm)),e.atp&&(t+=-1==e.atp.search(/trace/)?" ("+e.atp+Common.SPC+"bar)":" ("+e.atp+")"),t},mag:function(e){var t="";return e.dip&&""!==e.dip&&(t=e.dip+Common.SPC+"Gauss"),e.dipt&&(t+="; Tilt:"+e.dipt+this.unit("i")),t},mass:function(e,t){var n,r,a;if(e)return r=e,a=e.replace(/[\d\.\-e~<,]/g,""),r=a.length<1&&t?(parseFloat(e)*t).toScience():-1!==e.search(/^\D/)?e.replace(a,""):parseFloat(e).toScience(),-1!=e.search(/\.\./)&&(n=e.split(".."),r+="â€¦"+parseFloat(n[1]).toScience()),""===a&&(a="kg"),r+Common.SPC+a},time:function(e){if(e){var t,n="",r=null;if(r=e.match(/^([-~e\d\.\?]+)(\w+)?/),null!==r){switch(r[2]){case"s":t="s";break;case"mn":case"n":t="min";break;case"hr":case"h":t="h";break;case"dy":case"d":t="d";break;case"mo":case"m":t="mon";break;case"yr":case"y":case"a":t="a";break;default:t=r[2]}n=r[1]+Common.SPC+t}return n}},sumType:function(e){var t,n=0;for(t in e)e.hasOwnProperty(t)&&(n+=e[t]);return n},sumField:function(e,t){var n,r=0;for(n in e)e.hasOwnProperty(n)&&(r+=e[n][t]);return r}},parseObject=function(e){var t,n,r,a={},i={},o=function(){var e,t,n;for(e=i.desc.split(";"),n=0;n<e.length;n++)switch(t=e[n].split(":"),t[0]){case"url":t.length>1&&(i.hp="http://"+t[1]);break;case"sc":i.scale=parseFloat(t[1]);break;case"scmoons":i.scmoons=parseFloat(t[1]);break;case"orb":i.orb=t[1];break;case"moon":i.moons=t[1];break;case"opa":i.opa=parseFloat(t[1]);break;case"rsize":i.rsize=t[1].split(",");break;case"x":i.x=parseInt(t[1]);break;case"y":i.y=parseInt(t[1])}if(i.scale||(i.scale=1),i.moons){for(e=i.moons.split(","),n=0;n<e.length;n++)e[n]=Common.names.find(e[n]).n;i.moons=e.join(", ")}else i.moons=""},s=function(){var e;i.peri&&""!==i.peri&&(e=i.peri.split(":"),i.peri=e[1],i.peri+=" ("+Parse.distance(e[0])+")")},l=function(){var e,t;if(i.gr&&""!==i.gr){for(t=i.gr.split(/[\;\:]/),e=0;e<t.length;e++)t[e]=Common.names.find(t[e]).n;i.group=t.join(", ")}},c=function(){var e,t,n;if(i.cen&&""!==i.cen){for(t=i.cen.split(/\;/),e=0;e<t.length;e++)n=t[e].split(/\:/),t[e]=n[0]+": "+n[1];i.census=t.join(", ")}},h=function(){var e,t,n,r=[];if(i.url&&""!==i.url){for(t=i.url.split(/\;/),e=0;e<t.length;e++)n=t[e].split(/\:/),r.push(Read.url(n));i.url=r}};r=e,i.acr=e;for(t in objects[r])objects[r].hasOwnProperty(t)&&(i[t]=objects[r][t]);if(n=i.type,a.mass=Common.names.findMass(i.par),i.img=i.img&&""!==i.img?Common.symbols[r]:null,"m"==n&&i.desig&&""!==i.desig?i.fname=i.desig+" "+i.name:"r"==n?(i.name&&-1==i.name.search(/Division|Arc|Gap/)&&(i.name+=" Ring"),i.fname=i.other&&""!==i.other?i.name+" ("+i.other+")":i.name):i.fname="c"==n?i.desig&&""!==i.desig?i.desig+"/"+i.name:i.name:("a"==n||"d"==n||"t"==n)&&i.desig&&""!==i.desig?"("+i.desig+") "+i.name:i.name,i.dia&&""!==i.dia?(i.diam=Parse.diameter(i.dia),i.eqrad=parseFloat(i.dia)/2,i.rad=Parse.rad(i.dia)):i.diam="-","r"==n&&(i.w=i.diam?i.diam:"-",i.rad||(i.rad=1),i.thick&&""!==i.thick&&(i.h=Parse.thickness(i.thick),i.th=Parse.thick(i.thick)),i.th||(i.th=.001),i.h||(i.h="-"),i.peri=i.rad?Math.round(parseFloat(i.a)-i.rad):parseFloat(i.a),i.dist=Parse.distance(i.peri+"km"),i.len&&""!==i.len&&(i.len=Parse.distance(i.len+"i")),i.opt&&""!==i.opt&&(i.opt=i.opt.replace("..","â€¦"))),-1!=n.search(/^(d|a|c|t)$/)&&(l(),s()),-1!=n.search(/^(b)$/)&&c(),"p"==n||"d"==n){i.nmoons=0,i.nrings=0;for(t in objects)objects[t].par==r&&("m"==objects[t].type&&i.nmoons++,"r"==objects[t].type&&i.nrings++)}return i.orbit=Parse.elements(i,"aei"),i.tilt&&(i.tilt+=Parse.unit("i")),i.per=Parse.time(i.per),i.rot=Parse.rotation(i.rot),i.dens&&""!==i.dens&&(i.dens+=Common.SPC+"g/cm^3"),i.grav&&""!==i.grav&&(i.grav+=Common.SPC+"g"),i.irad&&""!==i.irad&&(i.irad+=Common.SPC+"W/m^3"),i.sdens&&""!==i.sdens&&(i.sdens+=Common.SPC+"g/cm^2"),i.temp&&""!==i.temp&&(i.temp=i.temp.replace(/K/g,Common.SPC+"K")),i.comp=Parse.comp(i.comp),i.spec&&""!==i.spec&&(i.comp+=" ("+i.spec+"-Type)"),i.atm=Parse.atm(i),i.mag=Parse.mag(i),i.mass=Parse.mass(i.mass,a.mass),i.disc&&""!==i.disc&&""!==i.dyr&&(i.disc=i.disc+", "+i.dyr),h(),o(),i},Obs=function(e,t){var n=scopes[e],r={},a=(t?document.getElementById(t):document.body,function(){var e,t;for(e=Read.data(n.name),r.name=Read.string(e[0]),r.shortname=Read.string(e[0],!0),r.url=[],e=Read.data(n.url),t=0;t<e.length;t++)r.url[t]=Read.url(e[t]);for(e=Read.data(n.icon),e&&e.length>0&&(r.icon=[{i:SOBS.SCOPES+e[0][0],n:r.name}]),e=Read.data(n.desc),t=0;t<e.length;t++)r[e[t][0]]=l(e[t]);for(r.stat=n.stat,r.parts=[],t=0;t<n.parts.length;t++)r.parts[t]=i(n.parts[t]);for(r.ev=[],t=0;t<n.ev.length;t++)r.ev[t]=o(n.ev[t]);if(n.inst)for(r.inst=[],t=0;t<n.inst.length;t++)r.inst[t]=s(n.inst[t]);if(r.lo=null,r.hi=null,r.inst)for(t=0;t<r.inst.length;t++)r.inst[t].hasOwnProperty("tp")&&-1!=r.inst[t].tp.search(/par|em|psp|msp/)||r.inst[t].hasOwnProperty("band")&&r.inst[t].band.hasOwnProperty("f0")&&((null==r.lo||r.inst[t].band.f0<r.lo)&&(r.lo=r.inst[t].band.f0),(null==r.hi||r.inst[t].band.f1>r.hi)&&(r.hi=r.inst[t].band.f1))}),i=function(e){var t,n,a={};if(e.n&&""!=e.n)for(a.name=[],t=Read.data(e.n),n=0;n<t.length;n++)a.name.push(Read.string(t[n]));for(e.ctry&&""!=e.ctry&&(a.ctry=c(e.ctry)),e.type&&""!=e.type&&(a.type=h(e.type),a.tp=e.type.split(";")),e.pur&&""!=e.pur&&(a.purpose=u(e.pur),a.pur=e.pur.split(";")),e.id&&""!=e.id&&(a.id=m(e.id)),e.url&&""!=e.url&&(a.url=d(e.id)),a.icon=e.icon&&""!=e.icon?f(e.icon,a):r.icon,t=Read.data(e.desc),n=0;n<t.length;n++)a[t[n][0]]=l(t[n]);return!a.hasOwnProperty("ag")&&r.hasOwnProperty("ag")&&(a.ag=r.ag),!a.hasOwnProperty("lv")&&r.hasOwnProperty("lv")&&(a.lv=r.lv),!a.hasOwnProperty("fam")&&r.hasOwnProperty("fam")&&(a.fam=r.fam),!a.hasOwnProperty("m")&&r.hasOwnProperty("m")&&(a.m=r.m),a.stat=e.hasOwnProperty("stat")&&""!=e.stat?e.stat:r.stat,a},o=function(e){var t,n,r={};if(r.pt=e.pt&&""!=e.pt?e.pt:0,e.dt&&""!=e.dt?(r.date={n:Parse.date(e.dt)},r.dt=Parse.dt(e.dt)):r.date="?",e.tp&&""!=e.tp&&(r.tp=[Common.names.find(e.tp)]),e.loc&&""!=e.loc&&(r.loc=p(e.loc,r.tp)),e.desc&&""!=e.desc)for(n=Read.data(e.desc),t=0;t<n.length;t++)r[n[t][0]]=l(n[t]);return r},s=function(e){var t,n,r={};if(e.n&&""!=e.n)for(r.name=[],t=Read.data(e.n),n=0;n<t.length;n++)r.name.push(Read.string(t[n],!0));if(r.pt=e.pt&&""!=e.pt?e.pt:0,t=e.tp&&""!=e.tp?e.tp:"im",r.tp=t,r.type=Common.names.find(t),e.band&&""!=e.band&&(r.band=g(e.band)),e.res&&""!=e.res&&(r.res=S(e.res)),e.d&&""!=e.d&&(r.d=parseFloat(e.d)),e.px&&""!=e.px&&(r.px=parseFloat(e.px)),e.tres&&""!=e.tres&&(r.tres=parseFloat(e.tres)),e.sres&&""!=e.sres&&(r.sres=parseFloat(e.sres)),e.sens&&""!=e.sens&&(r.sens=parseFloat(e.sens)),e.fov&&""!=e.fov&&(r.fov=parseFloat(e.fov)),e.foc&&""!=e.foc&&(r.foc=parseFloat(e.foc)),e.ea&&""!=e.ea&&(r.ea=parseFloat(e.ea)),e.url&&""!=e.url&&(r.url=d(e.id)),e.desc&&""!=e.desc)for(t=Read.data(e.desc),n=0;n<t.length;n++)r[t[n][0]]=l(t[n]);return r},l=function(e){var t,n;if(e&&!(e.length<2)){switch(e[0]){case"eom":case"pend":t=Common.names.find(e[0]);break;case"mal":case"fail":n=Common.names.find(e[0]),t=Common.names.find(e[1]),t.n=n[0]+": "+t.n;break;case"ag":t=Common.names.find(e[1]);break;case"lv":n=Common.names.findLV(e[1]),t=n?{n:e[1],id:"lnk"+n}:{n:e[1]};break;case"fam":t=Common.names.find(e[1]);break;case"m":t={n:e[1].toCommaString().replace(/kg/g,Common.SPC+"kg")};break;case"c":case"cl":case"x":case"y":case"sc":t=e[1];break;default:return}return t}},c=function(e){var t,n,r=[];for(t=Read.data(e),n=0;n<t.length;n++)Common.ctry.hasOwnProperty(t[n][0])&&r.push({n:Common.ctry[t[n][0]].name,k:t[n][0]});return r},h=function(e){var t,n,r=[];for(t=Read.data(e),n=0;n<t.length;n++)r.push(Common.names.find(t[n][0]));return r},u=function(e){var t,n,r=[];for(t=Read.data(e),n=0;n<t.length;n++)r.push(Common.names.find(t[n][0]));return r},m=function(e){var t=[];if(e&&""!=e)return t.push({n:e,u:SOBS.IDLNK+e,t:"_blank"}),t},d=function(e){var t,n,r=[];for(t=Read.data(e),n=0;n<t.length;n++)r.push(Read.url(t[n]));return r},f=function(e,t){var n,a,i,o=[];for(i=t.n&&t.n.length>0?t.n[0].n:r.name.n,n=Read.data(e),a=0;a<n.length;a++)o.push({i:SOBS.SCOPES+n[a][0],n:i});return o},p=function(e,t){var n,r,a,i=[];for(n=e.split(":"),a=n[0],r=1;r<n.length;r++)i.push(-1==n[r].search(/^\d/)?Common.names.find(n[r]):-1!=n[r].search(/x/)?{n:Parse.orbit(n[r],a)}:{n:Parse.distance(n[r],a)});return"l"==t&&(e=n[1],-1==SOBS.lc.search(e)&&(SOBS.lc+=e+",")),i},g=function(e){var t,n,r={};if(e||""!=e)return r.s=e,n=e.match(/([a-zA-Z]+)$/),n=null!=n?n[1]:"Hz",t=e.split(".."),r.f0=y(t[0],n),t.length>1&&(r.f1=y(t[1],n)),r.f0&&r.f1&&r.f0>r.f1&&(t=r.f0,r.f0=r.f1,r.f1=t),r},S=function(e){var t,n={};if(e&&""!=e)return t=e.split(".."),n.r0=t[0],n.r1=t.length>1?t[1]:null,n},y=function(e,t){var n,r,a;if(e&&""!=e){if(r=-1==e.search(/[a-zA-Z]$/)?e+t:e,n=r.match(/([afpnumckMGTPE]?)(eV|m|Hz)$/i),null==n)return parseFloat(e);switch(a=prefix(n[1]),r=parseFloat(e),n[2].toLowerCase()){case"hz":return r*a;case"ev":return e2f(r*a);case"m":return w2f(r*a)}}},w=function(){var e,t,n,a,i,o,s,l,c,h=[];if(!r.inst||!r.inst[0])return null;for(e=0;e<r.inst.length;e++)t=r.inst[e],("im"==t.tp||"is"==t.tp)&&(n=r.shortname.n,a=t.pt&&""!=t.pt?t.pt:0,t.name&&t.name.length>0&&(i=t.name[0].n),s=t.c?t.c:null,o=r.parts[a].hasOwnProperty("name")?r.parts[a].name[0].n:null,l=r.parts[a].hasOwnProperty("tp")?r.parts[a].tp[0]:null,c=r.parts[a].hasOwnProperty("pur")?r.parts[a].pur[0]:null,t.px&&t.d?h.push({tp:l,pur:c,st:r.parts[a].stat,n:n,i:i,p:o,f0:t.band.f0,f1:t.band.f1,px:t.px,d:t.d,c:s}):t.res&&h.push({tp:l,pur:c,st:r.parts[a].stat,n:n,i:i,p:o,f0:t.band.f0,f1:t.band.f1,r0:t.res.r0,r1:t.res.r1,c:s}));return h},v=function(){var e,t,n,a,i,o,s,l,c,h,u,m,d,f,p=[];if(!r.inst||!r.inst[0])return null;for(e=0;e<r.inst.length;e++)t=r.inst[e],t.band&&("im"==t.tp||"is"==t.tp)&&(n=t.pt&&""!=t.pt?t.pt:0,a=r.shortname.n,i=t.name&&t.name.length>0?t.name[0].n:"",o=t.pt?r.parts[t.pt].name[0].n:null,s=t.cl?t.cl:t.c?t.c:null,d=r.x?parseInt(r.x):0,f=r.y?parseInt(r.y):0,l=r.parts[n].hasOwnProperty("tp")?r.parts[n].tp[0]:null,h=r.parts[n].hasOwnProperty("pur")?r.parts[0].pur[0]:null,u=r.parts[0].hasOwnProperty("icon")&&null!=r.parts[0].icon?r.parts[0].icon[0].i:null,m=r.hasOwnProperty("sc")?r.sc:1,c=r.parts[n].stat,p.push({tp:l,pur:h,st:c,n:a,i:i,p:o,img:u,sc:m,f0:t.band.f0,f1:t.band.f1,fm:(r.hi+r.lo)/2,fl:r.lo,fh:r.hi,c:s,x:d,y:f}));return p};this.Instruments=function(e){return e&&"line"!=e?w():v()},a()},Sobs=new function(){var e,t,n,r,a={},i=function(){var e,t;e=0;for(t in scopes)a[t]=new Obs(t,r),e++},o=function(){var e,t,n={};e=0;for(t in SOBS.images)n[t]=new Image,n[t].src=SOBS.images[t],-1==SOBS.images[t].search(/\.cur/)&&e++;return numImages=e,n},s=function(){var e,t,n,r={};for(e in Common.ctry)t=Common.ctry[e].desc.match(/x\:(\d+);y\:(\d+)/),null!=t&&(r[e]={n:Common.ctry[e].name,x:t[1],y:t[2]});for(e in Common.desc)Common.desc[e].hasOwnProperty("desc")&&(t=Common.desc[e].desc.match(/x\:(\d+);y\:(\d+)/),null!=t&&(n=Common.desc[e].name.split(":"),n=n.length>1?n[1]+" ("+n[0]+")":n[0],r[e]={n:n,x:t[1],y:t[2]}));for(e in Common.loc)Common.loc[e].hasOwnProperty("desc")&&(t=Common.loc[e].desc.match(/x\:(\d+);y\:(\d+)/),null!=t&&(n=Common.loc[e].name.split(":"),n=n.length>1?n[1]+" ("+n[0]+")":n[0],r[e]={n:n,x:t[1],y:t[2]}));return r};this.load=function(){var t,r,o,s=[];i();for(o in a)t=a[o].Instruments(SOBS.TYPE),null!=t&&(s=s.concat(t));s.sort(function(e,t){return e.fm-t.fm}),r=new Diag,r.draw(n,SOBS.TYPE,s,e,height)},this.init=function(){if(cfg)for(var a in cfg)SOBS[a]=cfg[a];return e=SOBS.WIDTH,height=SOBS.HEIGHT,Common.names=new Names("SOBS"),Common.SPC=SOBS.SPC,Common.symbols=o(),Common.sprites=s(),SOBS.PARENT&&(r=document.getElementById(SOBS.PARENT)),r||(r=document.getElementsByTagName("body")[0]),t=Create.div(r,"","canvas-wrap",{w:e,h:2}),n=new Cdraw("canvas",{parent:"canvas-wrap",width:e,height:window.innerHeight}),{p:r,c:n.setheight,w:e}}};